generator client {
  provider = "prisma-client-js"
  output   = "../src/generated/prisma/client"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model categoria {
  id_categoria      Int                 @id @default(autoincrement())
  nombre            String              @db.VarChar(100)
  fecha_inicio      DateTime?           @db.Date
  fecha_fin         DateTime?           @db.Date
  genero            String?             @db.VarChar(1)
  tipo              String              @db.VarChar(10)
  categoria_config  categoria_config[]
  equipo            equipo[]
  fixture           fixture[]
  inscripcion       inscripcion[]
  sponsor_categoria sponsor_categoria[]
  tabla_posicion    tabla_posicion[]
}

model categoria_config {
  id            Int       @id @default(autoincrement())
  id_categoria  Int
  jugadores     Int?      @default(0) @db.SmallInt
  equipos       Int?      @default(0) @db.SmallInt
  fixtures      Int?      @default(0) @db.SmallInt
  posiciones    Int?      @default(0) @db.SmallInt
  texto         String?
  reglamento    String?   @default("empty") @db.VarChar(255)
  ver_jugadores Int?      @default(0) @db.SmallInt
  categoria     categoria @relation(fields: [id_categoria], references: [id_categoria], onDelete: NoAction, onUpdate: NoAction)
}

model configuracion {
  clave String  @id @db.VarChar(100)
  valor String? @db.VarChar(255)
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model equipo {
  id_equipo                          Int              @id @default(autoincrement())
  nombre                             String           @db.VarChar(100)
  id_torneo                          Int
  id_categoria                       Int
  tipo_equipo                        String           @db.VarChar(10)
  zona                               String?          @db.VarChar(20)
  categoria                          categoria        @relation(fields: [id_categoria], references: [id_categoria], onDelete: NoAction, onUpdate: NoAction)
  torneo                             torneo           @relation(fields: [id_torneo], references: [id_torneo], onDelete: NoAction, onUpdate: NoAction)
  equipo_jugador                     equipo_jugador[]
  fixture_fixture_id_equipo1Toequipo fixture[]        @relation("fixture_id_equipo1Toequipo")
  fixture_fixture_id_equipo2Toequipo fixture[]        @relation("fixture_id_equipo2Toequipo")
  pago_equipo                        pago_equipo[]
  tabla_posicion                     tabla_posicion[]

  @@index([id_categoria], map: "idx_equipo_categoria")
  @@index([id_torneo], map: "idx_equipo_torneo")
}

model equipo_jugador {
  id_equipo  Int
  id_jugador Int
  puesto     String? @db.VarChar(45)
  nivel      String? @db.VarChar(45)
  equipo     equipo  @relation(fields: [id_equipo], references: [id_equipo], onDelete: NoAction, onUpdate: NoAction)
  jugador    jugador @relation(fields: [id_jugador], references: [id_jugador], onDelete: NoAction, onUpdate: NoAction)

  @@id([id_equipo, id_jugador])
}

model fixture {
  id_fixture                        Int       @id @default(autoincrement())
  id_torneo                         Int
  id_categoria                      Int
  id_equipo1                        Int
  id_equipo2                        Int
  fecha                             DateTime? @db.Timestamp(6)
  cancha                            String?   @db.VarChar(100)
  estado                            String?   @db.VarChar(20)
  resultado1                        Int?
  resultado2                        Int?
  observaciones                     String?   @db.VarChar(300)
  categoria                         categoria @relation(fields: [id_categoria], references: [id_categoria], onDelete: NoAction, onUpdate: NoAction)
  equipo_fixture_id_equipo1Toequipo equipo    @relation("fixture_id_equipo1Toequipo", fields: [id_equipo1], references: [id_equipo], onDelete: NoAction, onUpdate: NoAction)
  equipo_fixture_id_equipo2Toequipo equipo    @relation("fixture_id_equipo2Toequipo", fields: [id_equipo2], references: [id_equipo], onDelete: NoAction, onUpdate: NoAction)
  torneo                            torneo    @relation(fields: [id_torneo], references: [id_torneo], onDelete: NoAction, onUpdate: NoAction)
  gol                               gol[]
  tarjeta                           tarjeta[]

  @@index([id_categoria], map: "idx_fixture_categoria")
  @@index([id_torneo], map: "idx_fixture_torneo")
}

model gol {
  id_fixture Int
  id_jugador Int
  minuto     Int
  tipo       String? @db.VarChar(45)
  fixture    fixture @relation(fields: [id_fixture], references: [id_fixture], onDelete: NoAction, onUpdate: NoAction)
  jugador    jugador @relation(fields: [id_jugador], references: [id_jugador], onDelete: NoAction, onUpdate: NoAction)

  @@id([id_fixture, id_jugador, minuto])
}

model inscripcion {
  id_inscripcion Int            @id @default(autoincrement())
  id_jugador     Int
  id_torneo      Int
  id_categoria   Int
  socio          Boolean?
  monto          Decimal?       @db.Decimal(10, 2)
  aprobado       Boolean?
  categoria      categoria      @relation(fields: [id_categoria], references: [id_categoria], onDelete: NoAction, onUpdate: NoAction)
  jugador        jugador        @relation(fields: [id_jugador], references: [id_jugador], onDelete: NoAction, onUpdate: NoAction)
  torneo         torneo         @relation(fields: [id_torneo], references: [id_torneo], onDelete: NoAction, onUpdate: NoAction)
  pago_jugador   pago_jugador[]

  @@unique([id_jugador, id_torneo])
}

model jugador {
  id_jugador             Int              @id @default(autoincrement())
  dni                    String           @unique @db.VarChar(10)
  nombre                 String           @db.VarChar(200)
  sexo                   String           @db.VarChar(1)
  fecha_nacimiento       DateTime?        @db.Date
  telefono               String?          @db.VarChar(45)
  emergencia_contacto    String?          @db.VarChar(200)
  socio_club             Boolean?         @default(false)
  nivel                  String?          @db.VarChar(45)
  grado                  String?          @db.VarChar(10)
  responsable_entrenador Boolean?         @default(false)
  id_responsable         Int?
  equipo_jugador         equipo_jugador[]
  gol                    gol[]
  inscripcion            inscripcion[]
  responsable            responsable?     @relation(fields: [id_responsable], references: [id_responsable], onDelete: NoAction, onUpdate: NoAction)
  tarjeta                tarjeta[]
}

model pago_equipo {
  id_pago        Int         @id @default(autoincrement())
  id_responsable Int
  id_equipo      Int
  fecha          DateTime?   @db.Date
  lugar          String?     @db.VarChar(100)
  recibo         String?     @db.VarChar(50)
  monto          Decimal?    @db.Decimal(10, 2)
  equipo         equipo      @relation(fields: [id_equipo], references: [id_equipo], onDelete: NoAction, onUpdate: NoAction)
  responsable    responsable @relation(fields: [id_responsable], references: [id_responsable], onDelete: NoAction, onUpdate: NoAction)

  @@index([id_equipo], map: "idx_pago_equipo_eq")
  @@index([id_responsable], map: "idx_pago_equipo_resp")
}

model pago_jugador {
  id_pago        Int         @id @default(autoincrement())
  id_responsable Int
  id_inscripcion Int
  fecha          DateTime?   @db.Date
  lugar          String?     @db.VarChar(100)
  recibo         String?     @db.VarChar(50)
  monto          Decimal?    @db.Decimal(10, 2)
  inscripcion    inscripcion @relation(fields: [id_inscripcion], references: [id_inscripcion], onDelete: NoAction, onUpdate: NoAction)
  responsable    responsable @relation(fields: [id_responsable], references: [id_responsable], onDelete: NoAction, onUpdate: NoAction)

  @@index([id_inscripcion], map: "idx_pago_jugador_inscripcion")
  @@index([id_responsable], map: "idx_pago_jugador_responsable")
}

model responsable {
  id_responsable Int            @id @default(autoincrement())
  dni            BigInt         @unique
  nombre         String         @db.VarChar(250)
  telefono       String?        @db.VarChar(45)
  email          String?        @db.VarChar(100)
  jugador        jugador[]
  pago_equipo    pago_equipo[]
  pago_jugador   pago_jugador[]
}

model sponsor {
  id_sponsor        Int                 @id @default(autoincrement())
  nombre            String?             @db.VarChar(100)
  descripcion       String?             @db.VarChar(255)
  url_logo          String?             @db.VarChar(255)
  link_pagina       String?             @db.VarChar(255)
  orden             Int?
  principal         Boolean?            @default(false)
  sponsor_categoria sponsor_categoria[]
}

model sponsor_categoria {
  id           Int       @id @default(autoincrement())
  id_sponsor   Int
  id_categoria Int
  principal    Boolean?  @default(false)
  orden        Int?
  categoria    categoria @relation(fields: [id_categoria], references: [id_categoria], onDelete: NoAction, onUpdate: NoAction)
  sponsor      sponsor   @relation(fields: [id_sponsor], references: [id_sponsor], onDelete: NoAction, onUpdate: NoAction)

  @@unique([id_sponsor, id_categoria])
}

model tabla_posicion {
  id_posicion   Int       @id @default(autoincrement())
  id_torneo     Int
  id_categoria  Int
  id_equipo     Int
  zona          String    @db.VarChar(20)
  pj            Int?      @default(0)
  g             Int?      @default(0)
  e             Int?      @default(0)
  p             Int?      @default(0)
  gf            Int?      @default(0)
  gc            Int?      @default(0)
  dif           Int?      @default(0)
  pts           Int?      @default(0)
  fecha_calculo DateTime? @default(now()) @db.Timestamp(6)
  categoria     categoria @relation(fields: [id_categoria], references: [id_categoria], onDelete: NoAction, onUpdate: NoAction)
  equipo        equipo    @relation(fields: [id_equipo], references: [id_equipo], onDelete: NoAction, onUpdate: NoAction)
  torneo        torneo    @relation(fields: [id_torneo], references: [id_torneo], onDelete: NoAction, onUpdate: NoAction)

  @@unique([id_torneo, id_categoria, zona, id_equipo])
  @@index([id_torneo, id_categoria, zona], map: "idx_tabla_pos")
}

model tarjeta {
  id_fixture Int
  id_jugador Int
  minuto     Int
  tipo       String? @db.VarChar(45)
  fixture    fixture @relation(fields: [id_fixture], references: [id_fixture], onDelete: NoAction, onUpdate: NoAction)
  jugador    jugador @relation(fields: [id_jugador], references: [id_jugador], onDelete: NoAction, onUpdate: NoAction)

  @@id([id_fixture, id_jugador, minuto])
}

model texto {
  id        Int     @id @default(autoincrement())
  clave     String? @unique @db.VarChar(100)
  contenido String?
}

model torneo {
  id_torneo      Int              @id @default(autoincrement())
  nombre         String           @db.VarChar(100)
  estado         String?          @db.VarChar(20)
  fecha_inicio   DateTime?        @db.Date
  fecha_fin      DateTime?        @db.Date
  equipo         equipo[]
  fixture        fixture[]
  inscripcion    inscripcion[]
  tabla_posicion tabla_posicion[]
}

model usuario {
  id        Int      @id @default(autoincrement())
  username  String   @unique @db.VarChar(100)
  password  String   @db.VarChar(255)
  nombre    String   @db.VarChar(200)
  activo    Boolean  @default(true)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}
